(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4218:function(e,t,s){Promise.resolve().then(s.bind(s,383))},383:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Home}});var n=s(7437),l=s(6568),r=s.n(l),a=s(2265);function parseDate(e){let[t,s,n]=e.toLocaleDateString("en").split("/");return t=Number(t)>9?t:"0"+t,s=Number(s)>9?s:"0"+s,n=n.slice(2),"".concat(s,"-").concat(t,"-").concat(n)}var i=s(8672);s(8538),s(8380);let TimeBlock=e=>{let{selected:t,onClick:s,onMouseDown:l,onMouseEnter:r}=e;return(0,n.jsx)("div",{className:"h-5 text-center cursor-pointer w-12 leading-8 select-none border border-sold border-black hover:bg-gray-200",style:t?{backgroundColor:"green"}:{},onMouseDown:l,onMouseEnter:r,children:(0,n.jsx)("button",{type:"button",onClick:s,style:{display:"none"}})})};var components_TimeSelect=e=>{let{selectedBlocks:t,setSelectedBlocks:s,actions:l,presences:r,date:i}=e,[c,o]=a.useState(!1),u=a.useRef(-1),handleBlockClick=e=>{let n=[...t];n[e]=!n[e],s(n),l.updateContent(i,n)},handleMouseDown=e=>{o(!0),u.current=e,handleBlockClick(e)},handleMouseEnter=e=>{if(c){let n=u.current,r=Math.min(n,e),a=Math.max(n,e),c=t.map((e,t)=>t>=r&&t<=a);for(let e=0;e<48;e++)c[e]=c[e]||t[e];s(c),l.updateContent(i,c)}};return(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("div",{className:"w-1/4",children:(()=>{let e=[];for(let t=0;t<49;t++)e.push((0,n.jsx)("div",{className:"text-xs text-white h-5 align-top ",children:t%2==0?"".concat(t/2,":00"):""},t));return e})()}),(0,n.jsxs)("div",{className:"w-3/4 ml-4",children:[(0,n.jsx)("div",{className:"flex flex-col w-full",onMouseUp:()=>{o(!1),u.current=-1},children:(()=>{let e=[];for(let s=0;s<48;s++)e.push((0,n.jsx)(TimeBlock,{selected:t[s],onClick:()=>handleBlockClick(s),onMouseDown:()=>handleMouseDown(s),onMouseEnter:()=>handleMouseEnter(s)},s));return e})()}),(0,n.jsx)("br",{}),(0,n.jsx)("button",{type:"button",style:{backgroundColor:"red",width:"50px",height:"20px",color:"white"},onClick:()=>{s(Array(48).fill(!1)),l.updateContent(i,Array(48).fill(!1))},children:"clear"})]})]})};function Scheduler(e){let{content:t,actions:s,presences:l}=e,[r,c]=(0,a.useState)(new Date),[o,u]=(0,a.useState)([]),d=r?parseDate(new Date(r.toString())):"",[m,h]=a.useState(Array(48).fill(!1));return(0,a.useEffect)(()=>{let e=!1;t.forEach(t=>{if(t.date===d)return e=!e,0}),e?h(t.find(e=>e.date===d).selectedBlocks.slice()):s.addContent(d,Array(48).fill(!1))},[r,t]),(0,n.jsx)("div",{className:"flex  p-4",children:(0,n.jsxs)("article",{className:"flex items-center justify-evenly w-full",children:[(0,n.jsx)(i.ZP,{onChange:c,value:r,locale:"en-EN",showNeighboringMonth:!1,formatDay:(e,t)=>t.toLocaleString("en",{day:"numeric"}),tileClassName:e=>{let{date:s}=e;return t.find(e=>e.date===parseDate(s)&&e.selectedBlocks.includes(!0))?"highlight":""}}),(0,n.jsx)("div",{className:"items-center",children:(0,n.jsx)(components_TimeSelect,{selectedBlocks:m,setSelectedBlocks:h,actions:s,date:d,presences:l})})]})})}var c=s(8529),o=s.n(c);function CustomModal(e){return(0,n.jsx)(o(),{style:{overlay:{backgroundColor:"rgba(0, 0, 0, 0.75)"},content:{width:"80%",margin:"auto"}},isOpen:e.isOpen,children:(0,n.jsxs)("div",{className:"flex min-h-full flex-col justify-center px-6 py-12 lg:px-8",children:[(0,n.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-sm",children:[(0,n.jsx)("img",{className:"mx-auto h-10 w-auto",src:"/profile.svg",alt:"Your Company"}),(0,n.jsx)("h2",{className:"mt-10 text-center text-2xl font-bold leading-9 tracking-tight text-gray-900",children:"닉네임을 입력해 주세요"})]}),(0,n.jsx)("div",{className:"mt-10 sm:mx-auto sm:w-full sm:max-w-sm",children:(0,n.jsxs)("form",{className:"space-y-6",onSubmit:t=>{t.preventDefault(),e.onModalSubmit(!0)},children:[(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:"mt-2",children:(0,n.jsx)("input",{required:!0,className:"block w-full rounded-md border-0 py-1.5 px-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6",placeholder:"닉네임을 입력해 주세요",type:"text",value:e.userName,onChange:e.handleUsernameInput})})}),(0,n.jsx)("div",{children:(0,n.jsx)("button",{type:"submit",className:"flex w-full justify-center rounded-md bg-indigo-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",children:"확인"})})]})})]})})}var u=s(6691),d=s.n(u);s(9104);let createPeer=(e,t)=>"main"==t?(0,n.jsxs)("div",{className:"peer",children:[(0,n.jsx)("div",{className:"profile",children:(0,n.jsx)(d(),{src:"/profile.svg",alt:"profile",className:"profile-img",width:30,height:30})}),(0,n.jsx)("div",{className:"name speech-bubbles",children:e})]}):"other"==t?(0,n.jsxs)("div",{className:"peer",children:[(0,n.jsx)(d(),{src:"/profile.svg",alt:"profile",className:"profile-img",width:30,height:30}),(0,n.jsx)("span",{className:"name",children:e})]}):void 0;function ProfileStack(e){let[t,s]=(0,a.useState)(""),[l,r]=(0,a.useState)([]);(0,a.useEffect)(()=>{if(Array.isArray(e.presences)){let t=e.presences.reduce((e,t)=>{let{clientID:s,presence:n}=t,{userName:l}=n;return e[s]=l,e},{});s(t[e.myClientID]),delete t[e.myClientID],r(Object.values(t))}else console.error("props.presences is not an array.")},[e.presences]);let i=l.length+2,c=[],o=[];if(c.push(createPeer(t,"main")),i>4){c.push(createPeer(l[0],"main")),c.push(createPeer(l[1],"main"));for(let e=2;e<l.length;e++)o.push(createPeer(l[e],"other"));c.push((0,n.jsxs)("div",{className:"peer more",children:[(0,n.jsxs)("div",{className:"profile",children:["+",i-4]}),(0,n.jsx)("div",{className:"peer-more-list speech-bubbles",children:o})]}))}else for(let e=0;e<l.length;e++)c.push(createPeer(l[e],"main"));return(0,n.jsx)("div",{id:"peerList",children:c})}let m=[{date:parseDate(new Date),selectedBlocks:Array(48).fill(!1)}];function Home(){let[e,t]=(0,a.useState)(m),[s,i]=(0,a.useState)(!0),[c,o]=(0,a.useState)(""),[u,d]=(0,a.useState)(),[h,f]=(0,a.useState)({}),[p]=(0,a.useState)(()=>new(r()).Document("scheduleshare"));return(0,a.useEffect)(()=>{if(!c){i(!0);return}let e=new(r()).Client("https://api.yorkie.dev",{apiKey:"clk2es3prhcevnm90utg"});p.subscribe("presence",t=>{t.type!==l.DocEventType.PresenceChanged&&(d(e.getID()),f(p.getPresences()))}),async function(t,s){await e.activate(),await e.attach(t,{initialPresence:{userName:c}}),t.update(e=>{e.content||(e.content=m)},"create default content if not exists"),t.subscribe(e=>{s(t.getRoot().content)}),s(t.getRoot().content)}(p,e=>t(e))},[s]),(0,n.jsxs)("main",{children:[(0,n.jsx)(CustomModal,{isOpen:s,userName:c,handleUsernameInput:e=>{o(e.target.value)},onModalSubmit:()=>{i(!1)}}),s?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(ProfileStack,{presences:h,myClientID:u}),(0,n.jsx)("div",{className:"clear-both"}),(0,n.jsx)("hr",{className:"py-2"}),(0,n.jsx)(Scheduler,{content:e,actions:{addContent(e,t){p.update(s=>{s.content.push({date:e,selectedBlocks:t})})},deleteContent(e){p.update(t=>{let s;for(let n of t.content)if(n.date===e){s=n;break}s&&t.content.deleteByID(s.getID())})},updateContent(e,t){p.update(s=>{let n;for(let t of s.content)if(t.date===e){n=t;break}n&&(n.selectedBlocks=t)})}},presences:h})]})]})}},8380:function(){},9104:function(){}},function(e){e.O(0,[624,250,971,864,744],function(){return e(e.s=4218)}),_N_E=e.O()}]);